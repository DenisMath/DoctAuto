\documentclass[a4paper,12pt]{article}
\usepackage{a4wide}
\usepackage[cp1251]{inputenc}
\usepackage[english,russian,ukrainian]{babel}
\usepackage{amsfonts,amssymb,amsmath,amsthm,amscd,latexsym}
\usepackage{graphicx}
\usepackage[matrix,arrow,curve]{xy}
%\pagestyle{headings}
\usepackage{fancyhdr}
\fancyfoot{} \rhead{\thepage} \cfoot{} \lhead{}
\renewcommand{\headrulewidth }{ 0pt}
\pagestyle{fancy} \sloppy
\parindent = 1 cm
\topmargin - 16mm \textwidth  160mm \textheight 250mm
\oddsidemargin 10mm \evensidemargin 7mm
\newcommand*{\hm}[1]{#1\nobreak\discretionary{}%
{\hbox{$\mathsurround=0pt #1$}}{}}
\newcommand{\bb}[1]{{\bf #1}}
\renewcommand{\theequation}{\thesection.\arabic{equation}}
\numberwithin{equation}{subsection}
\newtheorem{theorem}{Теорема}[subsection]
\newtheorem{lemma}{Лема}[subsection]
\newtheorem{corollary}{Наслідок}[subsection]
\newtheorem{remark}{Зауваження}[subsection]
\newtheorem{definition}{Означення}[subsection]
\newtheorem{example}{Приклад}[subsection]
\newtheorem{hyp}{Гіпотеза}[subsection]
\renewcommand{\baselinestretch}{1.5}

\begin{document}
 

\begin{definition}\label{marked_type_tree_def}
Означимо {\bf розмічене дерево типу } $D_f$ для автоморфізму $f \in AutZ_2$ наступним чином. 
\begin{itemize}
\item Корінь дерева помітимо автоморфізмом $f$.
\item Якщо вершина n-го рівня розміченого дерева типу помічена автоморфізмом $a = (b,c)\circ\sigma$, то з n+1-им рівнем цю вершину з'єднує тільки одне ребро. Іншу вершину цього ребра помітимо автоморфізмом $b\circ c$
\item Якщо вершина n-го рівня розміченого дерева типу помічена автоморфізмом $a = (b,c)$, то з n+1-им рівнем цю вершину з'єднує два ребра. Іншу вершину одного ребра помітимо автоморфізмом $b$, другого ребра -  $c$.
\end{itemize}
Автоморфізм, що помічає вершину $t\in D_f$ дерева типу позначимо як $D_f(t)$.
Множину вершин n-го рівня дерева $D$ позначимо як $L_n(D)$.
\end{definition}

\begin{remark}\label{child_type_subtree}
За побудовою, піддерево розміченного дерева типу співпадає з розміченним деревом типу автоморфізму, що помічає корінь цього піддерева.
\end{remark}
\begin{lemma}\label{unique_solution_upper_vertex}
Нехай $$a = (a_1,a_2)\circ\sigma, b = (b_1,b_2)\circ\sigma$$ $$a' = a_1\circ a_2 ,b' = b_1\circ b_2 $$ та $a'$ і $b'$ спряжені в $FAutT_2$.

 Тоді $a$ і $b$ також спряжені в $FAutT_2$.
\end{lemma}
\begin{proof}
За умовою леми існує $x\in FAutT2$, такий, що $(a')^x = b' $.

 Покажемо, що $\hat{x} = (x, a_2\circ x \circ b_2^{-1})$ є скінченно-становим розв'язком рівняння спряженності
$$a^\chi = b$$

 Далі
$$(a_1\circ a_2)^x = b_1\circ b_2$$
 і тому % , скориставшись наступними співвідношеннями
% $$(z_1\circ z_2)^{z_1} = z_2\circ z_1 $$
% $$(z_1\circ z_2)^{z_2^{-1}} = z_2\circ z_1 $$
% $$(a_2\circ a_1)^{a_2\circ x\circ b_1} = b_2\circ b_1$$
$$a^{\hat{x}} = (x^{-1}, b_2\circ x^{-1} \circ a_2^{-1}) \circ (a_1,a_2)\circ \sigma \circ (x, a_2\circ x \circ b_2^{-1}) =$$
$$= (x^{-1}\circ a_1 \circ (a_2\circ x \circ b_2^{-1}),(b_2\circ x^{-1} \circ a_2^{-1})\circ a_2 \circ x )\circ \sigma= $$
$$= ((x^{-1}\circ (a_1 \circ a_2)\circ x) \circ b_2^{-1},b_2)\circ \sigma= ((b_1,b_2) \circ b_2^{-1},b_2)\circ \sigma =$$ $$ =(b_1,b_2)\circ \sigma = c $$
Оскільки автоморфізми $x, a_2, b_2$ - скінченно-станові, то і $a_2\circ x \circ b_2^{-1}$ є скінченно-становим. Отже $\hat{x}\in FAutT_2$, щ.т.д.
\end{proof}
\begin{theorem}\label{marked_trees_conj}
Автоморфізми $a$ та $b$ спряжені в $FAutT_2$ тоді, і лише тоді, коли існує ізоморфізм $\alpha$ їх розмічених дерев типу($D_a*\alpha = D_b$), для якого автоморфізми в відповідних вершинах попарно спряжені в $FAutT_2$
$$\forall t\in L_n(D_a), \exists x\in FAutT_2,\ D_a(t)^x= D_b(t*\alpha) $$
\end{theorem}
\begin{proof}
 $\Rightarrow$

Дійсно, нехай $a = (a_1,a_2), b = (b_1,b_2), a^x = b$
Тоді, або $x = (x_1, x_2)$ і маємо
$$a^x = (x_1^{-1},x_2^{-1})\circ (a_1,a_2)\circ (x_1, x_2) = (a_1^{x_1}, a_2^{x_2} ) = (b_1, b_2) $$ і, отже 
$$b_1 = a_1^{x_1} \quad b_2 = a_2^{x_2} $$
і при ізоморфізмі розмічених дерев типу $D_a$ та $D_b$  вершина, що помічена $a_1$ переходить в вершину, що помічена $b_1$, а вершина , що помічена $a_2$ переходить в вершину, що помічена $b_2$.

 або $x = (x_1, x_2)\circ \sigma$ і маємо
$$a^x = \sigma \circ (x_1^{-1},x_2^{-1})\circ (a_1,a_2)\circ (x_1, x_2) \circ \sigma = \sigma \circ (a_1^{x_1}, a_2^{x_2} )\circ \sigma  = (a_2^{x_2}, a_1^{x_1} )\circ \sigma\circ \sigma = (a_2^{x_2}, a_1^{x_1} )= (b_1, b_2) $$ і, отже 
$$b_1 = a_2^{x_2}  \quad b_2 = a_1^{x_1} $$

і при ізоморфізмі розмічених дерев типу $D_a$ та $D_b$  вершина, що помічена $a_1$ переходить в вершину, що помічена $b_2$, а вершина , що помічена $a_2$ переходить в вершину, що помічена $b_1$.

Далі, нехай $a = (a_1,a_2)\circ \sigma, b = (b_1,b_2)\circ \sigma, a^x = b$
Тоді, або $x = (x_1, x_2)$ і маємо
$$a^x = (x_1^{-1},x_2^{-1})\circ (a_1,a_2)\circ \sigma \circ (x_1, x_2) = (x_1^{-1}\circ a_1\circ x_2,x_2^{-1}\circ a_2 \circ x_1 )\circ \sigma = (b_1, b_2)\circ \sigma$$ і, отже 
$$b_1 =x_1^{-1}\circ a_1\circ x_2 $$
$$b_2 = x_2^{-1}\circ a_2 \circ x_1 $$
$$b_1\circ b_2 = (a_1\circ a_2)^{x_1} $$
$$b_2\circ b_1 = (a_2\circ a_1)^{x_2} $$

 або $x = (x_1, x_2)\circ \sigma$ і маємо
$$a^x = \sigma \circ (x_1^{-1},x_2^{-1})\circ (a_1,a_2)\circ \sigma \circ (x_1, x_2) \circ \sigma =$$ $$=\sigma \circ  (x_1^{-1}\circ a_1\circ x_2,x_2^{-1}\circ a_2 \circ x_1 )\circ \sigma \circ \sigma =$$ $$= \sigma \circ  (x_1^{-1}\circ a_1\circ x_2,x_2^{-1}\circ a_2 \circ x_1 ) =  $$ $$= (x_2^{-1}\circ a_2 \circ x_1, x_1^{-1}\circ a_1\circ x_2 ) \circ \sigma = (b_1, b_2)\circ \sigma$$ і, отже 
$$b_1 =x_2^{-1}\circ a_2 \circ x_1 $$
$$b_2 = x_1^{-1}\circ a_1\circ x_2 $$
$$b_1\circ b_2 =(a_2\circ a_1)^{x_2} $$
$$b_2\circ b_1 =  (a_1\circ a_2)^{x_1} $$

Згідно з вищезазначеним, відповідні автоморфізми дерева типу спряжені станами автоморфізму $x$.

 $\Leftarrow$ Якщо такий ізоморфізм розміченних дерев типу існує, то автоморфізми, якими помічаются корені цих дерев, спряжені, отже автоморфізми $a$ та $b$ спряжені в $FAutT_2$.

\end{proof}

Зауважимо, що достатньо перевірити спряженність автоморфізмів хоча б одного рівня. Дійсно, згідно з лемою \ref{unique_solution_upper_vertex}, зі спряженності відповідних автоморфізмів $(n+1)$-го рівня випливає спряженність  автоморфізмів $n$-го рівня.  Отже, згідно з  теоремою \ref{marked_trees_conj}, має місце наступна теорема:
\begin{theorem}\label{marked_trees_conj_level}

Автоморфізми $a$ та $b$ спряжені в $FAutT_2$ тоді і лише тоді, коли існує ізоморфізм їх розмічених дерев типу($D_a*\alpha = D_b$), для якого  існує рівень, що всі автоморфізми в відповідних вершинах цього рівня попарно спряжені в $FAutT_2$
$$\exists n\in\mathbb{N}, \forall t\in L_n(D_a), \exists x\in FAutT_2\ D_a(t)^x= D_b(t*\alpha) $$
\end{theorem}
Зауважимо, що оскільки у спряженних автоморфізмів їх дерева типу ізоморфні, то в умові теореми \ref{marked_trees_conj_level} достатньо ізоморфізму $(D_a)_n$ та $(D_b)_n$

\begin{theorem}\label{Spherical_lin_tree}
Дерево типу автоморфізму вигляду $f(x) = ax+b, f \in AutZ_2$ є ланцюгом тоді, і лише тоді, коли $a = 4k+1, b = 2t+1$.
\end{theorem}
\begin{proof}
$\Rightarrow$ Якщо $b = 2t$, то дерево типу для $f$ не є ланцюгом, оскільки
$$(ax+2t) = \left(ax + t, ax + t + \frac{a-1}{2}\right)$$
отже маємо розгалуження в дереві типу $D_f$ на 0-му рівні.

Якщо $a = 4k+3, b = 2t+1$, то
 $$(4k+3)x+(2t+1)) = ((4k+3)x + t, (4k+3)x + t + 1 + 2k+1)\circ \sigma$$
 і 1-й рівень $D_f$ складається з однієї вершини, яка помічена автоморфізмом 
 $$((4k+3)x + t)\circ ((4k+3)x + t + 2k+1) = (4k+3)^2x +t(4k+3)+t+ 1 + 2k+1 =$$
 $$ = (4k+3)^2x +2(2t+1)(k+1) =$$ $$= ((4k+3)^2x +(2t+1)(k+1),(4k+3)^2x +((2t+1)+4(2k+1))(k+1)) $$
отже маємо розгалуження в дереві типу $D_f$ на 1-му рівні.

$\Leftarrow$ 1-й рівень дерева типу автоморфізму вигляду $f(x) = (4k+1)x+(2t+1)$ складається з однієї вершини. Далі:
$$x*\pi_L(f) = (4k+1)x+t$$ $$ x*\pi_R(f) = (4k+1)x+(t+1)+2k $$ 
$$x*\pi_L(f)\circ \pi_R(f) = (4k+1)((4k+1)x+t)+(t+1)+2k =$$
 $$= (4k+1)^2x + (4k+2)t + 2k + 1 = (4k'+1)x+(2t'+1), $$ 
$$k' = 4k^2 + 2k , t' = (2k+1)t + k$$
Отже кожний наступний рівень дерева для цього автоморфізму буде складатись з однієї вершини.
\end{proof}

\begin{lemma}\label{power_2_conj}
Автоморфізми $f(x)=ax+2^n$ та $g(x)=ax+2^n(2b'+1)$ спряжені в $FAutT_2$.
\end{lemma}
\begin{proof}
Дійсно, автоморфізми $f$ та $g$ спряжені за допомогою скінчено-станового автоморфізму $\chi (x) = (2b'+1)x$:
$$\left(\frac{1}{2b'+1}x\right)\circ (ax+2^n)\circ ((2b'+1)x)= \left(\frac{a}{2b'+1}x+2^n\right)\circ ((2b'+1)x)= $$
$$= (2b'+1)\left(\frac{a}{2b'+1}x+2^n\right) = ax + 2^n(2b'+1)$$
\end{proof}

\begin{lemma}\label{lin_states}
Мають місце наступні співвідношення:
$$(2k+1)x+2t = ((2k+1)x+t,(2k+1)x+k+t)$$
$$(2k+1)x+2t+1 = ((2k+1)x+t,(2k+1)x+k+t+1)\circ \sigma$$
\end{lemma}
\begin{proof}
Дійсно, для автоморфізму $f:Z_2\rightarrow Z_2$ вигляду $f = (f_1, f_2)$ маємо
$$f_1 = \frac{f(2x)}{2},\quad f_2 = \frac{f(2x+1)-1}{2}$$
 а для автоморфізму $f:Z_2\rightarrow Z_2$ вигляду $f = (f_1, f_2)\circ\sigma$ маємо
$$f_1 = \frac{f(2x)-1}{2},\quad f_2 = \frac{f(2x+1)}{2}$$
Автоморфізм $ f(x) = (2k+1)x $ має вигляд $$ f = (f_1, f_2) $$ оскільки  залишає першу цифру двійкового розкладу x без зміни.
Отже $$(2k+1)x = ((2k+1)x,(2k+1)x+k)$$
%Крім того, мають місце наступні співвідношення

$$x+2k+1 = (x+k, x+k+1)\circ\sigma$$
Оскільки $f(x)=x+2k$, очевидно, залишає першу цифру двійкового розкладу x без зміни, то
$$\pi_L(x+2k) =  \frac{2x+2k}{2} = x+k, \quad \pi_R(x+2k) =  \frac{2x+1+2k-1}{2} = x+k $$
тому 
$$x+2k = (x+k,x+k)$$
Для  $f(x)=x+2k+1$ маємо:
$$x+2k+1 = (x+2k)\circ (x+1) = (x+k,x+k)\circ (x,x+1)\circ\sigma = (x+k, x+k+1)\circ\sigma $$
Отже
$$(2k+1)x+2t = (2k+1)x\circ(x+2t) =$$ $$=  ((2k+1)x,(2k+1)x+k)\circ  (x+t,x+t)=$$ $$ = ((2k+1)x+t,(2k+1)x+k+t) $$
Аналогічно отримуємо:
$$(2k+1)x+2t+1 = (2k+1)x\circ(x+2t+1) = $$ $$= ((2k+1)x,(2k+1)x+k)\circ  (x+t, x+t+1)\circ\sigma = $$ $$= ((2k+1)x+t,(2k+1)x+k+t+1)\circ\sigma $$
щ.т.д.
\end{proof}
% \begin{theorem}\label{All_lin_tree}
% Для довільного автоморфізму  вигляду $f(x) = (2k+1)x+(2t+1), f \in AutZ_2$ існує натуральне число $N$, таке, що для довільного рівня його розміченного дерева типу, з номером більшим за $N$, кожен автоморфізм, що помічає його вершини, має вигляд $g(x) = (4k'+1)x+t'$ .
% \end{theorem}

\begin{lemma}\label{exist_ax_2b_1}
Для довільного не тотожнього автоморфізму вигляду $f(x) = ax+b, f \in AutZ_2$ знайдеться вершина  його розміченого дерева типу, що помічена автоморфізмом вигляду $g(x) = ax+(2b'+1)$.
\end{lemma}
\begin{proof}
Дійсно, за лемою \ref{lin_states}
$$(2k+1)x+2^nt = ((2k+1)x+2^{n-1}t,(2k+1)x+2^{n-1}t+k) $$ отже, якщо вершина розміченного дерева типу помічена автоморфізмом $(2k+1)x+2^n(2t+1)$, то з цієї вершини виходить дві гілки, і інші їх вершини помічені автоморфізмами $(2k+1)x+2^{n-1}(2t+1)$ та $ (2k+1)x+2^{n-1}(2t+1)+k $. Отже, якщо $b\neq 0$, то рівно за $n$ рівнів знайдеться вершина розміченного дерева типу помічена автоморфізмом $(2k+1)x+(2t+1)$

Якщо $b= 0, k\neq 0$, то $$(2k+1)x = ((2k+1)x,(2k+1)x+k ) $$ і до автоморфізму $(2k+1)x+k $ можна застосувати попередні міркування.
\end{proof}



\begin{theorem}\label{exist_4k_1}
Для довільного не тотожнього автоморфізму  вигляду $f(x) = ax+b, f \in AutZ_2$ знайдеться вершина  його розміченого дерева типу, що помічена автоморфізмом вигляду $g(x) = (4k'+1)x+(2t'+1)$.
\end{theorem}
\begin{proof}
Дійсно, за лемою \ref{exist_ax_2b_1}
знайдеться вершина  розміченого дерева типу, що помічена автоморфізмом вигляду $ax+(2t+1)$.


Оскільки $ax+b$ - ізометрія кільця $Z_2$, то $a = 2k+1$. Далі, з вершини розміченного дерева типу, що помічена автоморфізмом $(2k+1)x+(2t+1)$, виходить одна гілка, інша вершина якої, за лемою \ref{lin_states}, помічена автоморфізмом
 $$((2k+1)x+t)\circ ((2k+1)x+k+t+1)= (2k+1)((2k+1)x+t)+k+t+1 =$$ 
$$= (2k+1)^2x + (2k+1)t+k+t+1 = (4(k^2+k)+1)x + (k+1)(2t+1) =$$ $$= (4k'+1)x+t' $$ 

За лемою \ref{exist_ax_2b_1}, в піддереві розміченого дерева типу з вершиною, поміченною автоморфізмом $ (4k'+1)x+t' $ знайдеться вершина, помічена автоморфізмом $ (4k'+1)x+(2t''+1) $, щ.т.д.
\end{proof}

З теореми \ref{Spherical_lin_tree} та теореми \ref{exist_4k_1} випливає:
\begin{theorem}\label{chain_inside}
 В дереві типу не тотожнього лінійного автоморфізму знайдеться хоча б один ланцюг
\end{theorem}

\begin{definition}\label{vertex_index}
Співставимо кожній вершині дерева типу автоморфізму індекс, що дорівнює кількості розгалужень, починаючи з кореня на шляху до цієї вершини. Наприклад, якщо дерево типу є ланцюгом, то індекс кожної його вершини дорівнює 0.
\end{definition}

\begin{remark}\label{equal_index}
Легко бачити, що для ізоморфізму $\phi : D_1 \rightarrow D_2$ двох дерев типу індекс образу вершини $\phi(x) \in D_2$ дорівнює індексу прообразу вершини $x\in D_1$.
\end{remark}

\begin{lemma}\label{marked_vertex_value}
Для автоморфізму $f(x)=ax+b$ автоморфізм, що маркує вершину n-го рівня розміченного дерева типу має вигляд
$$a^{2^{n-k+1}}x+b'$$
 де k - індекс цієї вершини.
\end{lemma}
\begin{proof}
Дійсно, за лемою \ref{lin_states}
$$(2k+1)x+t = ((2k+1)x+t,(2k+1)x+t+k) $$ отже, якщо вершина розміченного дерева типу помічена автоморфізмом $(2k+1)x+(2t+1)$, то з цієї вершини виходить дві гілки, і інші їх вершини помічені автоморфізмами $(2k+1)x+2^{n-1}(2t+1)$ та $ (2k+1)x+2^{n-1}(2t+1)+k $. Отже при розгалуженні автоморфізми, що маркують вершини наступного рівня мають такий же самий коефіцієнт біля x.

Далі, з вершини розміченного дерева типу, що помічена автоморфізмом $(2k+1)x+(2t+1)$ виходить одна гілка, інша вершина якої, за лемою \ref{lin_states}, помічена автоморфізмом
 $$((2k+1)x+t)\circ ((2k+1)x+k+t+1)= (2k+1)^2x + (2k+1)t+k+t+1 $$ 
Отже в цьому випадку автоморфізм, що маркує вершину наступного рівня має  коефіцієнт біля x, що дорівнює квадрату попереднього коефіцієнту. Отже отримуємо твердження теореми.

\end{proof}

\begin{lemma}\label{minus_coeff_type_tree}
Два не тотожніх лінійних автоморфізми $f(x) = ax+b'$ та $g(x) = -ax+b''$ мають неізоморфні дерева типу.
\end{lemma}
\begin{proof}
Якщо $a$ має вигляд $4k'+1$ то $-a$ має вигляд $4k''+3$ ($-4k'-1 = -4(k'+1)+3$).

Припустимо, що автоморфізми $f$ та $g$ мають ізоморфні дерева типу :
$$D_f*\alpha = D_g$$
За лемою \ref{marked_vertex_value} для довільного $n\in \mathbb{N}$ всі вершини  $n$-го рівня з індексом $n$ в розміченому дереві типу $D_{(4k'+1)x+b}$  помічені автоморфізмами вигляду $(4k'+1)x+b'$.

 Множина таких вершин не є порожньою, оскільки принаймні містить корінь дерева $D_{(4k'+1)x+b}$.

 З іншого боку, оскільки автоморфізм $(4k'+1)x+b$ не є тотожнім, то серед вершин $n$-го рівня з індексом $n$ знайдеться вершина $ v\in D_{(4k'+1)x+b} $, помічена автоморфізмом вигляду $(4k'+1)x+(2t+1)$ (інакше в кожній вершині дерева типу маємо розгалуження, що відповідає тотожньому автоморфізму).

 За теоремою \ref{Spherical_lin_tree} піддерево дерева типу $D_{(4k'+1)x+b}$ з коренем в вершині $v$ є ланцюгом.

 При ізоморфізмі $\alpha$ дерев $D_{(4k'+1)x+b}$ та $D_{(4k''+3)x+c}$  образ $v*\alpha \in D_{(4k''+3)x+c} $ цієї вершини  має такий самий індекс, як і $v$, і, за лемою \ref{marked_vertex_value}, автоморфізм, що помічає вершину  $v*\alpha$, має вигляд 
$ (4k''+3)x+c' $.

 Але, за теоремою \ref{Spherical_lin_tree}, дерево типу автоморфізму  піддерево дерева типу $D_{(4k''+3)x+c}$ з коренем в вершині $v*\alpha$ не є ланцюгом. Отже маємо протиріччя.



\end{proof}

\begin{theorem}\label{lin_conj_rightarrow}
Два  лінійних автоморфізми $f(x) = ax+b$ та $g(x) = cx+d$ можуть бути спряжені лише тоді, коли $a=c$ .
\end{theorem}
\begin{proof}
Нехай автоморфізми $f$ та $g$ спряжені в $FAutT_2$.

За теоремою \ref{chain_inside} в розміченому дереві типу $D_f$ автоморфізму $f$ знайдеться ланцюг. Нехай $v$ - вершина в $D_f$, що належить цьому ланцюгу.
 За лемою \ref{marked_vertex_value} автоморфізм, що маркує цю вершину має вигляд $a^{2^{n-k+1}}x+b'$, де k - індекс вершини $v$, а n - номер рівня, якому вона належить.


Згідно з теоремою \ref{marked_trees_conj},  при ізоморфізмі $\alpha$ дерев типу $D_f$ та $D_g$ автоморфізм $a^{2^{n-k+1}}x+b'$, що маркує вершину $v \in D_f$ спряжений в $FAutT_2$ з автоморфізмом, що маркує вершину $v*\alpha \in D_g$.

Згідно з зауваженням \ref{equal_index} та лемою \ref{marked_vertex_value} автоморфізм, що маркує вершину $v*\alpha \in D_g$  має вигляд $c^{2^{n-k+1}}x+b''$.

 Згідно з зауваженням \ref{child_type_subtree} дерева типу автоморфізмів $a^{2^{n-k+1}}x+b'$ та $c^{2^{n-k+1}}x+b''$ є ланцюгом, а отже є сферично-транзитивними.

 За теоремою про спряженість сферично-транзитивних лінійних  автоморфізмів в $FAutT_2$ маємо рівність  $$ a^{2^{n-k+1}} = c^{2^{n-k+1}} $$
Отже $a = \pm c$, але, оскільки $f$ та $g$ спряжені в $FAutT_2$, то, за лемою \ref{minus_coeff_type_tree}, маємо рівність $a =  c$, щ.т.д.

\end{proof}


\begin{theorem}\label{power_two_lin_conj}
Два лінійних автоморфізми $f(x) = ax+2^r(2b+1)$ та $g(x) = cx+2^r(2d+1)$ спряжені тоді, і лише тоді, коли $a=c$.
\end{theorem}
\begin{proof}
$\Rightarrow$ Нехай f та g - спряжені в $FAutT_2$. За теоремою \ref{lin_conj_rightarrow} - $a=c$.

$\Leftarrow$ Нехай $a=c$. Тоді $ f(x) = ax+2^r(2b+1)$ та $ g(x) = cx+2^r(2d+1)$ спряжені скінчено-становим автоморфізмом $$\chi_0(x) = \left(\frac {2d+1}{2b+1}\right)x$$

Дійсно
$$ \chi_0^{-1}\circ f \circ \chi_0 = \left(\left(\frac{2b+1}{2d+1}\right)x\right) \circ (ax+2^r(2b+1)) \circ  \left(\left(\frac{2d+1}{2b+1}\right)x\right) = $$
$$=  \left(a\left(\frac{2b+1}{2d+1}\right)x+2^r(2b+1)\right) \circ  \left(\left(\frac{2d+1}{2b+1}\right)x\right) = $$
$$= \left(\frac{2d+1}{2b+1}\right)\left(a\left(\frac{2b+1}{2d+1}\right)x+2^r(2b+1)\right) =  ax+2^r(2d+1) = $$
$$ = cx+2^r(2d+1)  $$
\end{proof}
\begin{remark}
За теоремою \ref{lin_conj_rightarrow} автоморфізми $f(x) = ax$ та $g(x) = cx$ спряжені тоді, і лише тоді, коли $a=c$ .
\end{remark}


\begin{theorem}\label{4kp1ConjFinal}
Скінчено-станові автоморфізми $f(x)=(2^s(2k+1)+1)x + b_1$ та $g(x)=(2^s(2k+1)+1)x + b_2$, $s > 0$ спряжені в $FAutT_2$, якщо $ b_1 \equiv b_2 (\mod 2^s) $. 
\end{theorem}
\begin{proof}
Оскільки $ b_1 \equiv b_2 (\mod 2^s) $, то
 $$\frac{b_1-b_2}{2^s(2k+1)}\in Z_2$$

Автоморфізми $f$ та $g$ спряжені в $FAutT_2$ за допомогою скінчено-станового автоморфізму
 $$\chi(x) = x + \frac{b_1-b_2}{2^s(2k+1)}$$ 

Дійсно, має місце наступна рівність:
$$\chi ^{-1}\circ f \circ \chi  = (x - \frac{b_1-b_2}{2^s(2k+1)}) \circ ((2^s(2k+1)+1)x + b_1) \circ (x + \frac{b_1-b_2}{2^s(2k+1)}) =  $$
$$= ((2^s(2k+1)+1)(x - \frac{b_1-b_2}{2^s(2k+1)}) + b_1) \circ (x + \frac{b_1-b_2}{2^s(2k+1)}) = $$
$$ = (2^s(2k+1)+1)x - \frac{(2^s(2k+1)+1 - 1)(b_1-b_2)}{2^s(2k+1)} + b_1 =  (2^s(2k+1)+1)x + b_2 $$

\end{proof}

\begin{lemma}\label{4kp3PowerTwoConj}
Скінчено-станові автоморфізми $f(x)=(4k+3)x + 2b_1$ та $g(x)=(4k+3)x + 2b_2$ спряжені в $FAutT_2$  
\end{lemma}
\begin{proof}
Є наслідком теореми \ref{4kp1ConjFinal}.
\end{proof}

\begin{theorem}\label{4kp3ConjFinal}
Скінчено-станові автоморфізми $f(x)=(4k+3)x + b_1$ та $g(x)=(4k+3)x + b_2$ спряжені в $FAutT_2$ тоді, і лише тоді, коли $ b_1 \equiv b_2 (\mod 2)$ 
\end{theorem}
\begin{proof}
$\Leftarrow$ Згідно з лемою \ref{lin_states}, 1-й рівень дерева типу автоморфізму $ax+(2t+1)$ складається з однієї вершини, а 1-й рівень дерева типу автоморфізму $ax+2t$ складається з двох вершин. Отже автоморфізми  $f(x)=(4k+3)x + b_1$ та $g(x)=(4k+3)x + b_2$ не спряжені в $AutT_2$, а отже і в $FAutT_2$, якщо $ b_1 \not\equiv b_2 (\mod 2)$.


$\Rightarrow$ За теоремою  \ref{power_two_lin_conj}  та лемою \ref{4kp3PowerTwoConj}.
\end{proof}



\begin{theorem}
Автоморфізми $f(x)= x + 2^n$ та $g(x)= x + 2^m$ спряжені в $AutT_2$ тоді, і лише тоді, коли $m=n$. 
\end{theorem}
\begin{proof}
Дійсно, мають місце наступні співвідношення:
$$(x+2^n) = (x+2^{n-1}, x+2^{n-1})$$
$$(x+1) = (x , x+1)\circ \sigma$$
Отже дерево типу автоморфізму $f(x)= x + 2^n$ до n-го рівня ізоморфно $(T_2)_n$ і кожна вершина n-го рівня є коренем ланцюга в дереві типу $D_{x+2^n}$, звідси маємо тверження теореми.
\end{proof}

 \begin{theorem}
 Автоморфізми $f(x)= (2^s(2k+1)+1)x + 2^n, n<s$ та $g(x)= (2^s(2k+1)+1)x + 2^m, m<s$($s>1$) спряжені в $AutT_2$ тоді, і лише тоді, коли $m = n$. 
\end{theorem}
\begin{proof}
За теоремою \ref{Spherical_lin_tree}, дерево типу автоморфізму   $f(x)= (2^s(2k+1)+1)x + 1, s>1$ є ланцюгом.

Далі, має місце співвідношення:
$$( (2^s(2k+1)+1)x+2^n) = ( (2^s(2k+1)+1)x+2^{n-1},  (2^s(2k+1)+1)x+2^{s-1}(2k+1)+2^{n-1} ) = $$
 $$ =  ( (2^s(2k+1)+1)x+2^{n-1},  (2^s(2k+1)+1)x+2^{n-1}((2k+1)2^{s-n}+1 )) $$
Оскільки число $(2k+1)2^{s-n}+1$ - непарне при $n<s$, то, за лемою \ref{power_2_conj} , автоморфізм $(2^s(2k+1)+1)x+2^{s-1}((2k+1)+2^{n-s} )$ спряжен автоморфізму $(2^s(2k+1)+1)x+2^{n-1} $, і вони мають ізоморфні дерева типу.

 Тому, згідно з зауваженням \ref{child_type_subtree}, автоморфізми 
$$( (2^s(2k+1)+1)x+2^{n-1},  (2^s(2k+1)+1)x+2^{s-1}(2k+1)+2^{n-1} )$$
та
$$( (2^s(2k+1)+1)x+2^{n-1},  (2^s(2k+1)+1)x+2^{n-1} )$$
мають ізоморфні дерева типу.

Отже дерево типу автоморфізму $f(x)= (2^s(2k+1)+1)x + 2^n, n<s, s>1$ до n-го рівня ізоморфно $(T_2)_n$ і кожна вершина n-го рівня є коренем ланцюга в дереві типу $D_{(2^s(2k+1)+1)x + 2^n}$, звідси маємо тверження теореми.

\end{proof}

 \begin{lemma}\label{4kp1ConjNull}
 Скінчено-станові автоморфізми $f(x)= (2^s(2k+1)+1)x + 2^n, n<s, s> 1$ та $g(x)= (2^s(2k+1)+1)x $ не спряжені в $AutT_2$. 
\end{lemma}
\begin{proof}
Оскільки має місце співвідношення
$$ (2^s(2k+1)+1)x = ((2^s(2k+1)+1)x, (2^s(2k+1)+1)x + 2^{s-1}(2k+1)  $$
то в дереві типу $D_{(2^s(2k+1)+1)x}$ для довільного n знайдеться вершина n-го рівня, що не є коренем ланцюга - це вершина, помічена автоморфізмом $ (2^s(2k+1)+1)x $.

З іншого боку, кожна вершина n-го рівня є коренем ланцюга в дереві типу $D_{(2^s(2k+1)+1)x + 2^n}$, тому дерева типу $D_{(2^s(2k+1)+1)x + 2^n}$ та $D_{(2^s(2k+1)+1)x}$ не ізоморфні.

 Отже автоморфізми $f(x)= (2^s(2k+1)+1)x + 2^n, n<s, s> 1$ та $g(x)= (2^s(2k+1)+1)x $ не спряжені в $FAutT_2$.
% $\Leftarrow$ Згідно з лемою \ref{lin_states}, 1-й рівень дерева типу автоморфізму $ax+(2t+1)$ складається з однієї вершини, а 1-й рівень дерева типу автоморфізму $ax+2t$ складається з двох вершин. Отже автоморфізми  $f(x)=(4k+3)x + b_1$ та $g(x)=(4k+3)x + b_2$ не спряжені в $AutT_2$, а отже і в $FAutT_2$, якщо $ b_1 \not\equiv b_2 (\mod 2)$.


% $\Rightarrow$ За теоремами  \ref{power_two_lin_conj}  та \ref{4kp3PowerTwoConj}.
\end{proof}


\begin{definition}
Означимо функцію $\phi_a(x)$ наступним чином:
            \begin{equation*}
            \phi_a(b) =
            \begin{cases}
                -n-1, \; a = 1,\; b = 2^n(2t+1) ; \\  
                \; 2^s,\;  a = 2^s(2k+1)+1, s>0, \; b = 0 \\    
                \; (2^n \mod 2^s)+2^s,\; a = 2^s(2k+1)+1, s>0\; b = 2^n(2t+1) ; 
            \end{cases}
            \end{equation*}
          \end{definition}

          \begin{theorem}\label{final_lin_conj}
Два лінійних автоморфізми $f(x) = ax+b$ та $g(x) = cx+d$ спряжені тоді, і лише тоді, коли  $\phi_a(b) = \phi_c(d)$.
\end{theorem}

\begin{definition}\label{part_lin_def1}
Назвемо автоморфізм кусково-лінійним, якщо існує $n\in \mathbb{N}$, для якого всі стани n-го рівня цього автоморфізму є лінійними.
\end{definition}

\begin{remark}\label{All_lin_tree}
Для перевірки спряженості в $FAutT_2$ кусково-лінійних автоморфізмів достатньо застосувати теорему \ref{marked_trees_conj_level} до рівня, на якому усі стани ціх автоморфізмів лінійні,
 та теорему \ref{final_lin_conj} для попарної перевірки спряженості відповідних автоморфізмів, що маркують вершини цього рівня в деревах розміченого типу ціх автоморфізмів.
\end{remark}
 Наприклад, має місце наступна теорема:
\begin{theorem}\label{sph_tr_part_lin_conj}
Два скінчено-станові лінійні сферично-транзитивні  автоморфізми спряжені в $FAutT_2$ тоді, і лише тоді, коли знайдеться рівень, для якого всі автоморфізми цього рівня є лінійними, та добутки всіх коефіцієнтів біля х рівні для обох автоморфізмів.
\end{theorem}

\begin{example}
Кусочно-лінійні сферично-транзитивні автоморфізми $$f(x)= (5x +3 , 9x + 2 )\circ \sigma $$ та  $$g(x)= (15x , 3x+1 )\circ \sigma $$ за теоремою \ref{sph_tr_part_lin_conj} спряжені в $FAutT_2$, оскільки
$$5\cdot 9 = 15\cdot 3$$
\end{example}


 
  \end{document}
